{% extends 'manager/template.html' %}
{% load static %}

{% block content %}

<ul id="inquiry-list">
  <!-- 문의글 목록이 여기에 동적으로 삽입됩니다. -->
</ul>

<div id="inquiry-detail" style="display:none;">
  <h2>제목: <span id="inquiry-title"></span></h2>
  <p>내용: <span id="inquiry-content"></span></p>
  <p>답변: <span id="inquiry-response"></span></p>
  <button onclick="hideDetail()">닫기</button>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
// 문의글 목록을 서버로부터 불러오는 함수입니다.
function loadInquiries() {
  $.ajax({
    url: '/api/inquiries/', // 문의글 목록을 제공하는 API 엔드포인트
    type: 'GET',
    dataType: 'json',
    success: function(data) {
      var list = $('#inquiry-list');
      list.empty();
      $.each(data, function(index, inquiry) {
        var listItem = $('<li>').text(inquiry.title).attr('data-id', inquiry.id);
        listItem.on('click', function() {
          showDetail(inquiry.id);
        });
        list.append(listItem);
      });
    },
    error: function(xhr, status, error) {
      console.error('문의글을 불러오는 데 실패했습니다:', error);
    }
  });
}

// 선택된 문의글의 상세 내용을 서버로부터 불러와 보여주는 함수입니다.
function showDetail(inquiryId) {
  $.ajax({
    url: '/api/inquiries/' + inquiryId + '/', // 문의글 상세 정보를 제공하는 API 엔드포인트
    type: 'GET',
    dataType: 'json',
    success: function(data) {
      $('#inquiry-title').text(data.title);
      $('#inquiry-content').text(data.content);
      $('#inquiry-response').text(data.response);
      $('#inquiry-detail').show();
    },
    error: function(xhr, status, error) {
      console.error('문의글 상세 정보를 불러오는 데 실패했습니다:', error);
    }
  });
}

// 상세 내용을 숨기는 함수입니다.
function hideDetail() {
  $('#inquiry-detail').hide();
}

// 페이지가 로드될 때 문의글 목록을 불러옵니다.
$(document).ready(function() {
  loadInquiries();
});
</script>

{% endblock %}
