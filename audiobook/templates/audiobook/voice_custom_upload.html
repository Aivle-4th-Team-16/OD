{% extends 'audiobook/template.html' %}
{% load static %}

{% block content %}
    <style>
        .blue-box {
            background-color: #007BFF;
            padding: 20px;
            color: #fff;
            border-radius: 10px;
        }

        .upload-section {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-top: 20px;
        }

        .icon-svg {
            width: 50px;
            height: 50px;
        }

        .icon-img {
            height: 100px;
        }
    </style>

    <!-- 첫 번째 행 -->
    <div class="row mb-4">
        <div class="col">
            <p class="fs-3 fw-bold">나만의 목소리</p>
        </div>
    </div>

    <!-- 두 번째 행 -->
    <div class="row justify-content-center align-items-center gap-5 ">
        <div class="col-3">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-mic-fill icon-svg" viewBox="0 0 16 16" style="width: 100px; height: 100px;">
                <path d="M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0V3z"/>
                <path d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"/>
            </svg>
        </div>
        <div class="col-3">
            <img src="/static/images/speak.jpg" alt="Image 3" class="img" style='height:90px;'>
        </div>
        <div class="col-3">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-hourglass-split icon-svg" viewBox="0 0 16 16" style="width: 100px; height: 100px;">
                <path d="M2.5 15a.5.5 0 1 1 0-1h1v-1a4.5 4.5 0 0 1 2.557-4.06c.29-.139.443-.377.443-.59v-.7c0-.213-.154-.451-.443-.59A4.5 4.5 0 0 1 3.5 3V2h-1a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-1v1a4.5 4.5 0 0 1-2.557 4.06c-.29.139-.443.377-.443.59v.7c0 .213.154.451.443.59A4.5 4.5 0 0 1 12.5 13v1h1a.5.5 0 0 1 0 1h-11zm2-13v1c0 .537.12 1.045.337 1.5h6.326c.216-.455.337-.963.337-1.5V2h-7zm3 6.35c0 .701-.478 1.236-1.011 1.492A3.5 3.5 0 0 0 4.5 13s.866-1.299 3-1.48V8.35zm1 0v3.17c2.134.181 3 1.48 3 1.48a3.5 3.5 0 0 0-1.989-3.158C8.978 9.586 8.5 9.052 8.5 8.351z"/>
            </svg>
        </div>
        <div class="col-3">
            <p class="fs-6">  10분 분량의 음성 파일 녹음이 필요해요</p>
        </div>
        <div class="col-3">
            <p class="fs-6">  정확하고 다양한 높낮이로 녹음할수록 목소리가 잘 만들어져요</p>
        </div>
        <div class="col-3">
            <p class="fs-6">  목소리를 만드는데는 약 1시간이 걸려요</p>
        </div>
    </div>

    <!-- 공백  -->
    <div class="row justify-content-end"> </div>
    
    <!-- 네 번째 행 -->
    <div class="row mt-5 mb-3">
        <div class="col">
            <h2 class="bold-text text-center">음성을 정해주세요</h2>
        </div>
    </div>

    <!-- 다섯 번째 행 -->
    <div class="row gap-3 justify-content-center">
        <div class="col-6">
            <div class="input-group gap-4">
                <input type="file" class="form-control" id="voice_file" name="voice_file" accept="audio/*" aria-label="음성 파일 선택 " aria-describedby="upload-btn">
                <div class="input-group-append">
                    <button id="upload-btn" class="btn btn-primary" type="button">음성 파일 업로드</button>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-5"> </div>

    <!-- 네 번째 행 -->
    <div class="row mt-5 mb-3">
        <div class="col">
            <h2 class="bold-text text-center">내 을성의 이름을 정해주세요</h2>
        </div>
    </div>
    

    <!-- 다섯 번째 행 -->
    <div class="row gap-3 justify-content-center">
        <div class="col-6">
            <div class="input-group gap-4">
                <input type="text" class="form-control" id="voice_name" name="voice_name" placeholder="내 목소리의 이름" aria-label="내 목소리의 이름" aria-describedby="duplicate-check">
                <div class="input-group-append">
                    <button id="duplicate-check-btn" class="btn btn-primary" type="button">중복 확인</button>
                </div>
            </div>
        </div>
    </div>

    <div class="row justify-content-end mt-5"> </div>

    <!-- 목소리 생성하기 버튼 -->
    <div class="row justify-content-end mt-5">
        <!-- 필요한 필드들 추가 -->
        <div class="row justify-content-center">
            <div class="col-3">
                <button id="voice-create-btn" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#voiceCreateModal">목소리생성</button>
            </div>
        </div>
    </div>

    <!-- 부트스트랩 모달 -->
    <div class="modal fade" id="voiceCreateModal" tabindex="-1" role="dialog" aria-labelledby="voiceCreateModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="voiceCreateModalLabel">목소리 생성 중</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- 여기에 목소리 생성 중 문구 또는 로딩 아이콘 등을 추가할 수 있습니다. -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id='modal-btn'>닫기</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            
            // 클릭 활성화
            document.getElementById('duplicate-check-btn').addEventListener('click', checkDuplicate);
            document.getElementById('voice-create-btn').addEventListener('click', createVoice);
            
            // 중복 확인 버튼
            function checkDuplicate() {
                // voice_name 데이터를 localStorage에 저장
                var voiceName = document.getElementById('voice_name').value;
                console.log("실행됨", voiceName)
                localStorage.setItem('voice_name', voiceName);
            }

            // 목소리 생성 버튼
            function createVoice() {
                // 모달 표시
                $('#voiceCreateModal').modal('show');

                // 이후의 작업을 수행하고 모달을 닫은 후에 페이지 이동
                setTimeout(function () {
                    // 여기에 목소리 생성 작업을 수행하는 코드 추가

                    // 페이지 이동
                    window.location.href = "{% url 'audiobook:voice_custom_complete' %}";
                }, 200000); // 200초 후에 페이지 이동 수행
                    // 모달이 닫힐 때 발생하는 이벤트에 페이지 이동 코드 추가
                $('#voiceCreateModal').on('hidden.bs.modal', function () {
                    window.location.href = "{% url 'audiobook:voice_custom_complete' %}";
                });
            }

            // modal-btn 클릭 시 다음 페이지로 이동
            document.getElementById('modal-btn').addEventListener('click', function() {
                window.location.href = "{% url 'audiobook:voice_custom_complete' %}";
            });

        });

    </script>
{% endblock %}